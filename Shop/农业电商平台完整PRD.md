# 农业电商平台产品需求文档

## 1. 产品概述

### 1.1 产品定位
农业电商平台是一个连接农产品生产商、区域代理商和终端消费者的B2B2C综合电商平台，通过区域保护机制确保商品销售的合理性和代理商的利益，同时提供完整的供应链管理和数据分析功能。

### 1.2 核心价值
- 为生产商提供高效的商品管理和订单处理平台
- 为代理商提供透明的佣金结算和客户管理系统
- 为消费者提供优质的农产品和便捷的购物体验
- 通过区域保护机制维护市场秩序和各方利益

### 1.3 目标用户
- **平台管理员**：负责平台整体运营、商品审核、订单分配和系统管理
- **农产品生产商**：负责商品供应、库存管理和订单发货
- **区域代理商**：负责区域内商品推广、客户服务和佣金获取
- **终端消费者**：通过平台购买农产品

### 1.4 设计原则
- 以用户为中心，提供简洁直观的操作体验
- 确保系统的安全性、稳定性和可扩展性
- 实现数据的实时同步和透明化
- 支持多角色协同工作，提高运营效率

## 2. 用户角色与权限

### 2.1 平台管理员（Admin）
- **权限范围**：平台所有功能模块
- **核心职责**：
  - 商品审核和管理
  - 订单分配和监控
  - 店铺认证和管理
  - 区域保护规则设置
  - 用户权限管理
  - 系统配置和维护

### 2.2 农产品生产商（Vendor）
- **权限范围**：仅限自身商品和订单
- **核心职责**：
  - 商品信息维护和库存管理
  - 订单处理和发货
  - 区域保护规则设置
  - 代理申请审核
  - 销售数据分析

### 2.3 区域代理商（Reseller）
- **权限范围**：自身订单、客户和佣金
- **核心职责**：
  - 订单查询和跟踪
  - 佣金收入管理和提现
  - 客户信息管理
  - 代理团队管理
  - 销售业绩分析

### 2.4 终端消费者（Consumer）
- **权限范围**：购物相关功能
- **核心职责**：
  - 商品浏览和购买
  - 订单管理和查询
  - 收货地址管理
  - 售后服务申请

## 3. 功能模块详细设计

### 3.1 商城端功能

#### 3.1.1 商品与店铺浏览
- **功能点**：
  - 商品搜索（含店铺搜索）
  - 热门搜索推荐
  - 商品分类浏览
  - 商品列表展示（图片、名称、价格等）
  - 店铺信息展示（评分、配送时间等）

- **用户故事**：
  - 作为消费者，我希望能够通过搜索快速找到所需商品，以便节省购物时间
  - 作为消费者，我希望能够查看商品的分类列表，以便发现更多相关商品
  - 作为消费者，我希望能够了解店铺的评分和配送时间，以便做出购买决策

- **API设计**：
  ```
  GET /api/products - 获取商品列表（支持搜索、筛选、排序）
  GET /api/products/:id - 获取商品详情
  GET /api/shops - 获取店铺列表
  GET /api/shops/:id - 获取店铺详情
  ```

#### 3.1.2 商品详情
- **功能点**：
  - 商品图片展示（主图+缩略图）
  - 商品基本信息（名称、价格、规格等）
  - 商品属性（型号、规格、产地等）
  - 代理政策展示
  - 购买数量控制
  - 加入购物车和立即购买功能
  - 申请代理/经销商功能

- **用户故事**：
  - 作为消费者，我希望能够查看商品的详细信息和图片，以便了解商品的具体情况
  - 作为消费者，我希望能够选择购买数量并加入购物车，以便稍后统一结算
  - 作为潜在代理商，我希望能够查看代理政策并申请代理，以便开展业务

- **API设计**：
  ```
  GET /api/products/:id - 获取商品详情
  POST /api/cart/add - 加入购物车
  POST /api/orders/quick-purchase - 立即购买
  POST /api/agents/apply - 申请代理
  ```

#### 3.1.3 购物车
- **功能点**：
  - 商品列表展示（图片、名称、价格、数量）
  - 商品数量调整
  - 商品删除功能
  - 全选/单选功能
  - 店铺信息展示
  - 价格汇总（商品总价、运费、优惠等）
  - 优惠券选择

- **用户故事**：
  - 作为消费者，我希望能够在购物车中调整商品数量，以便购买合适的数量
  - 作为消费者，我希望能够查看商品的总价和优惠信息，以便了解最终支付金额
  - 作为消费者，我希望能够选择优惠券，以便享受更多优惠

- **API设计**：
  ```
  GET /api/cart - 获取购物车商品列表
  POST /api/cart/update - 更新购物车商品
  POST /api/cart/delete - 删除购物车商品
  GET /api/coupons/available - 获取可用优惠券
  ```

#### 3.1.4 订单流程
- **功能点**：
  - 收货地址选择和管理
  - 配送方式选择
  - 支付方式选择
  - 订单备注
  - 订单金额汇总
  - 区域保护检查和服务商分配
  - 支付流程

- **用户故事**：
  - 作为消费者，我希望能够选择收货地址和配送方式，以便商品能够准确送达
  - 作为消费者，我希望能够选择合适的支付方式，以便完成订单支付
  - 作为消费者，我希望能够了解订单的区域保护情况，以便确认服务提供商

- **API设计**：
  ```
  GET /api/addresses - 获取收货地址列表
  POST /api/orders/create - 创建订单
  POST /api/orders/pay - 订单支付
  GET /api/orders/:id - 获取订单详情
  ```

#### 3.1.5 用户中心
- **功能点**：
  - 个人信息管理
  - 订单管理（查看、取消等）
  - 收藏夹管理
  - 地址管理
  - 优惠券管理
  - 代理管理
  - 设置（密码修改、安全设置等）

- **用户故事**：
  - 作为消费者，我希望能够管理我的个人信息和收货地址，以便更便捷地购物
  - 作为消费者，我希望能够查看我的订单历史和状态，以便了解订单进度
  - 作为代理商，我希望能够查看我的代理信息和业绩，以便了解业务情况

- **API设计**：
  ```
  GET /api/user/profile - 获取用户信息
  PUT /api/user/profile - 更新用户信息
  GET /api/orders - 获取订单列表
  GET /api/favorites - 获取收藏夹列表
  GET /api/addresses - 获取地址列表
  ```

### 3.2 平台端功能

#### 3.2.1 商品管理模块
- **功能点**：
  - 商品信息维护（增删改查，批量操作）
  - 商品分类管理（多级分类，排序和状态）
  - 商品属性配置（自定义属性，多规格）
  - 库存管理（实时监控，预警，调整记录）
  - 商品审核（上架审核，违规下架）
  - 商品数据分析（销售趋势，库存周转率）

- **API设计**：
  ```
  GET /admin/api/products - 获取商品列表
  POST /admin/api/products - 创建商品
  PUT /admin/api/products/:id - 更新商品
  DELETE /admin/api/products/:id - 删除商品
  POST /admin/api/products/:id/audit - 审核商品
  ```

#### 3.2.2 订单管理模块
- **功能点**：
  - 订单处理（查询、状态更新、取消）
  - 订单分配（手动/自动，批量分配）
  - 订单调度（物流跟踪，配送状态）
  - 异常订单处理（取消、退款、投诉）
  - 订单数据分析（订单量、金额、状态分布）

- **API设计**：
  ```
  GET /admin/api/orders - 获取订单列表
  POST /admin/api/orders/:id/update-status - 更新订单状态
  POST /admin/api/orders/:id/assign - 分配订单
  POST /admin/api/orders/:id/cancel - 取消订单
  ```

#### 3.2.3 用户管理模块
- **功能点**：
  - 用户信息维护（增删改查，批量操作）
  - 用户权限管理（角色定义，权限分配）
  - 用户行为分析（登录记录，浏览记录，购买记录）
  - 用户分组管理（基于属性的分组，精准营销）
  - 用户满意度管理（评价管理，投诉处理）

- **API设计**：
  ```
  GET /admin/api/users - 获取用户列表
  POST /admin/api/users - 创建用户
  PUT /admin/api/users/:id - 更新用户
  DELETE /admin/api/users/:id - 删除用户
  POST /admin/api/roles - 创建角色
  ```

#### 3.2.4 店铺管理模块
- **功能点**：
  - 店铺信息维护（增删改查，批量操作）
  - 店铺认证审核（营业执照，资质）
  - 店铺评分管理（评价管理，规则设置）
  - 店铺运营数据分析（订单量，销售额，转化率）
  - 店铺违规处理（警告，处罚，封禁）

- **API设计**：
  ```
  GET /admin/api/shops - 获取店铺列表
  POST /admin/api/shops - 创建店铺
  PUT /admin/api/shops/:id - 更新店铺
  POST /admin/api/shops/:id/verify - 审核店铺
  ```

#### 3.2.5 区域保护管理模块
- **功能点**：
  - 区域范围设置（地理区域绘制，层级管理）
  - 保护规则配置（商品、店铺、价格）
  - 服务商分配（区域分配，服务商管理）
  - 区域冲突检测（重叠检测，冲突解决）
  - 保护执行监控（实时监控，异常预警）

- **API设计**：
  ```
  GET /admin/api/regions - 获取区域列表
  POST /admin/api/regions - 创建区域
  GET /admin/api/protection-rules - 获取保护规则
  POST /admin/api/protection-rules - 创建保护规则
  ```

### 3.3 厂家端功能

#### 3.3.1 商品管理模块
- **功能点**：
  - 商品信息维护（增删改查，批量操作）
  - 商品分类管理（基于平台分类的归类）
  - 商品属性配置（规格、参数，多SKU）
  - 库存管理（实时监控，预警，调整）
  - 商品上下架（状态管理，定时设置）
  - 商品销售统计（销量、销售额分析）

- **API设计**：
  ```
  GET /vendor/api/products - 获取厂家商品列表
  POST /vendor/api/products - 创建商品
  PUT /vendor/api/products/:id - 更新商品
  POST /vendor/api/products/:id/stock - 调整库存
  ```

#### 3.3.2 订单管理模块
- **功能点**：
  - 订单查询（分配给自己的订单）
  - 订单处理（确认订单，发货，物流录入）
  - 订单状态跟踪（实时查看状态，配送进度）
  - 异常订单处理（取消，退款申请）
  - 订单统计分析（订单量、销售额、客单价）

- **API设计**：
  ```
  GET /vendor/api/orders - 获取厂家订单列表
  POST /vendor/api/orders/:id/confirm - 确认订单
  POST /vendor/api/orders/:id/ship - 发货处理
  GET /vendor/api/orders/statistics - 获取订单统计
  ```

#### 3.3.3 区域保护管理模块
- **功能点**：
  - 区域规则设置（基于商品的保护规则）
  - 代理商管理（区域代理商查询，关系管理）
  - 保护规则监控（执行情况，异常提醒）
  - 区域销售分析（各区域销售数据对比）

- **API设计**：
  ```
  GET /vendor/api/protection-rules - 获取保护规则
  POST /vendor/api/protection-rules - 创建保护规则
  GET /vendor/api/agents - 获取代理商列表
  ```

#### 3.3.4 代理管理模块
- **功能点**：
  - 代理申请审核（处理申请，审核资质）
  - 代理关系管理（等级设置，区域分配）
  - 代理政策发布（佣金比例，考核规则）
  - 代理业绩管理（业绩查看，佣金结算）

- **API设计**：
  ```
  GET /vendor/api/agent-applications - 获取代理申请
  POST /vendor/api/agent-applications/:id/approve - 审核通过
  GET /vendor/api/agents/:id/performance - 获取代理业绩
  ```

### 3.4 代理端功能

#### 3.4.1 订单管理模块
- **功能点**：
  - 订单查询（分配给自己的订单）
  - 订单处理（跟踪，备注）
  - 订单状态跟踪（实时查看状态，配送进度）
  - 订单统计分析（订单量、销售额、佣金）

- **API设计**：
  ```
  GET /reseller/api/orders - 获取代理订单列表
  GET /reseller/api/orders/:id - 获取订单详情
  POST /reseller/api/orders/:id/comment - 添加备注
  ```

#### 3.4.2 佣金管理模块
- **功能点**：
  - 佣金收入查询（实时查看收入）
  - 佣金结算记录（历史记录，金额，时间）
  - 佣金规则查看（计算规则，比例）
  - 佣金提现申请（提交申请，查看进度）
  - 佣金统计分析（收入趋势，商品贡献）

- **API设计**：
  ```
  GET /reseller/api/commissions - 获取佣金列表
  POST /reseller/api/commissions/withdraw - 提交提现申请
  GET /reseller/api/commissions/rules - 获取佣金规则
  ```

#### 3.4.3 客户管理模块
- **功能点**：
  - 客户信息管理（查看和管理客户列表）
  - 客户分类（基于购买行为的分组）
  - 客户行为分析（购买记录，偏好）
  - 客户沟通记录（记录沟通内容）
  - 客户关怀（发送优惠券、促销信息）

- **API设计**：
  ```
  GET /reseller/api/customers - 获取客户列表
  GET /reseller/api/customers/:id - 获取客户详情
  POST /reseller/api/customers/:id/notes - 添加备注
  ```

#### 3.4.4 代理申请模块
- **功能点**：
  - 代理申请提交（填写表单，上传资质）
  - 申请进度查询（实时查看审核进度）
  - 代理政策查看（条件，佣金比例）
  - 代理等级查看（当前等级，升级条件）
  - 代理团队管理（查看下线代理）

- **API设计**：
  ```
  POST /reseller/api/apply - 提交代理申请
  GET /reseller/api/apply/status - 获取申请进度
  GET /reseller/api/team - 获取代理团队
  ```

## 4. 核心业务流程

### 4.1 商品发布与审核流程
1. 厂家登录厂家端，创建商品信息
2. 系统自动提交商品审核请求
3. 平台管理员审核商品信息
4. 审核通过后，商品上架销售
5. 审核不通过，厂家修改后重新提交

### 4.2 订单处理流程
1. 消费者下单购买商品
2. 系统根据区域保护规则分配订单
3. 厂家收到订单，确认并准备发货
4. 厂家录入物流信息，更新订单状态
5. 消费者确认收货，订单完成
6. 系统自动计算并结算佣金

### 4.3 区域保护流程
1. 消费者选择收货地址
2. 系统检查区域保护规则
3. 如触发保护规则，弹出提示框告知本地服务商
4. 消费者确认后，订单分配给本地服务商
5. 系统更新订单信息和金额

### 4.4 代理申请流程
1. 代理商登录代理端，提交代理申请
2. 系统自动发送申请给对应厂家
3. 厂家审核代理申请
4. 审核通过后，代理商获得代理权限
5. 审核不通过，告知原因

## 5. 非功能性需求

### 5.1 性能需求
- 系统响应时间：页面加载时间<2秒，API响应时间<500ms
- 并发处理能力：支持10000+并发用户
- 数据更新频率：实时更新库存和订单状态

### 5.2 安全需求
- 数据传输加密：采用HTTPS协议
- 数据存储加密：敏感数据加密存储
- 权限控制：基于RBAC的细粒度权限管理
- 日志审计：记录所有关键操作，便于追溯

### 5.3 可用性需求
- 系统可用性：≥99.9%
- 故障恢复时间：≤30分钟
- 备份策略：每日全量备份，实时增量备份

### 5.4 可扩展性需求
- 支持微服务架构，便于功能扩展
- 支持多语言、多货币扩展
- 支持第三方系统集成（支付、物流等）

## 6. 技术架构设计

### 6.1 前端技术栈
- **平台端**：React + TypeScript + Ant Design Pro
- **厂家端**：Vue.js 3 + TypeScript + Element Plus
- **代理端**：Vue.js 3 + TypeScript + Element Plus
- **商城端**：HTML5 + CSS3 + JavaScript + Tailwind CSS

### 6.2 后端技术栈
- **框架**：Java + Spring Boot 3.x + Node.js + NestJS
- **数据库**：MySQL 8.x + MongoDB + Redis 7.x
- **搜索引擎**：Elasticsearch 8.x
- **消息队列**：Kafka 3.x + RabbitMQ
- **缓存**：Redis
- **API文档**：Swagger 3.x

### 6.3 架构设计
- **微服务架构**：功能模块拆分为独立微服务
- **API网关**：统一入口，负载均衡，安全控制
- **服务注册与发现**：Nacos
- **配置中心**：Nacos Config
- **分布式事务**：Seata
- **监控系统**：Prometheus + Grafana
- **日志系统**：ELK Stack

## 7. 项目实施计划

### 7.1 第一阶段：基础功能实现（1-2个月）
- 商城端核心功能（商品浏览、详情、购物车、订单）
- 平台端基础功能（商品管理、订单管理、用户管理）
- 厂家端基础功能（商品管理、订单管理）
- 代理端基础功能（订单管理、佣金管理）

### 7.2 第二阶段：功能增强（2-3个月）
- 区域保护机制实现
- 代理申请和管理功能
- 数据分析和报表功能
- 移动端适配

### 7.3 第三阶段：系统集成（1-2个月）
- 第三方系统集成（支付、物流）
- 性能优化和安全加固
- 用户培训和文档编写

### 7.4 第四阶段：上线和运营（持续）
- 系统上线和监控
- 用户反馈收集和功能迭代
- 系统维护和性能优化

## 8. 风险评估与应对策略

### 8.1 技术风险
- **风险**：系统并发能力不足
- **应对策略**：采用微服务架构，增加缓存层，优化数据库索引

### 8.2 业务风险
- **风险**：区域保护规则执行不当
- **应对策略**：建立完善的规则测试机制，加强人工审核

### 8.3 运营风险
- **风险**：用户接受度不高
- **应对策略**：提供详细的用户培训，优化用户体验，增加营销活动

### 8.4 数据风险
- **风险**：数据泄露或丢失
- **应对策略**：加强数据加密，建立完善的备份和恢复机制，定期安全审计

## 9. 附录

### 9.1 术语定义
- **区域保护**：确保商品在特定区域内由指定代理商销售的机制
- **SKU**：Stock Keeping Unit，库存单位
- **佣金**：代理商通过销售商品获得的报酬
- **B2B2C**：Business to Business to Consumer，企业对企业对消费者的商业模式

### 9.2 参考文档
- 《商城端功能分析报告》
- 《平台端(Admin)功能模块优化方案》
- 《厂家端(Vendor)功能模块优化方案》
- 《代理端(Reseller)功能模块优化方案》

### 9.3 联系方式
- 产品经理：XXX
- 技术负责人：XXX
- 运营负责人：XXX

---

**文档版本**：V1.0
**编写日期**：2026-01-16
**更新日期**：2026-01-16
**审批人员**：XXX